(this["webpackJsonprelics-app"]=this["webpackJsonprelics-app"]||[]).push([[0],{10:function(e,t,a){e.exports=a(19)},15:function(e,t,a){},16:function(e,t,a){},19:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(8),s=a.n(i),c=(a(15),a(2)),o=a(3),l=a(4),u=a(5),h=(a(16),a(6));function m(e,t){return e.journalState.entries.push({entry:t,entryType:"COMMON"}),e.journalState.entries.length>=25&&e.journalState.entries.shift(),e}var d=function e(){Object(c.a)(this,e),this.resourceState=new v,this.jobAssignments=new f,this.journalState=new g,this.saveTime=new Date,this.settings=new p,this.achievements=new S},v=function e(){Object(c.a)(this,e),this.relics=0,this.relicGenerator=0,this.students=0,this.money=0,this.fame=0,this.whispers=0},f=function e(){Object(c.a)(this,e),this.gatherRelics=0},g=function e(){Object(c.a)(this,e),this.entries=[{entry:"The new dig site lays before me, I wonder what treasures lay yet unearthed?",entryType:"COMMON"}]},p=function e(){Object(c.a)(this,e),this.darkMode=!1},S=function e(){Object(c.a)(this,e),this.labUnlocked=!1};function b(){return!!localStorage.getItem("RelicsSave")}function k(){var e=localStorage.getItem("RelicsSave"),t=e?JSON.parse(atob(e)):null;return Object(h.a)({},new d,{},t)}function j(){return new d}function E(e){e.saveTime=new Date,localStorage.setItem("RelicsSave",btoa(JSON.stringify(e)))}var y=function(){function e(){Object(c.a)(this,e),this.updateClock=!1}return Object(o.a)(e,[{key:"commitTransaction",value:function(e,t){if(this.isValidPurchase(e,t)){var a=this.getCost(e,t);e.resourceState.relics-=a,e.resourceState.students+=t}return e}},{key:"isValidPurchase",value:function(e,t){var a=this.getCost(e,t);return e.resourceState.relics>=a}},{key:"getCost",value:function(e,t){for(var a=0,n=e.resourceState.students||0,r=0;r<t;r++)a+=15+10*n,n++;return a}}]),e}();function O(e){var t=e.jobAssignments.gatherRelics;return e.resourceState.students-t}var C=a(9),T=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var e=this.props,t=e.tooltip,a=e.id,n=e.children,i=e.disabled,s=e.onClick,c="relics-button";i&&(c+=" relics-button--disabled"),e.compact&&(c+=" relics-button--compact");var o=i?function(){}:s,l={};return t&&(l["data-tip"]="",l["data-for"]=a),r.a.createElement("span",Object.assign({},l,{id:a,className:c,onClick:o}),n,t&&r.a.createElement(C.a,{id:a,place:"bottom",effect:"solid"},t))}}]),a}(r.a.Component),N=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).studentTransaction=new y,e}return Object(o.a)(a,[{key:"assignGather",value:function(){!function(e,t){O(t)>=e&&(t.jobAssignments.gatherRelics+=e)}(1,this.props.gameState)}},{key:"removeGather",value:function(){!function(e,t){t.jobAssignments.gatherRelics-=e,t.jobAssignments.gatherRelics<0&&(t.jobAssignments.gatherRelics=0)}(1,this.props.gameState)}},{key:"render",value:function(){var e=this,t=this.props,a=t.gameState,r=t.onAddCurrency,i=t.onPurchase,s=O(a),c=a.resourceState.students>=1;return n.createElement("div",{className:"panel--left-align"},n.createElement("div",{className:"button-container"},n.createElement(T,{onClick:function(){return r("relics",1)}},"Look for relics")),c&&n.createElement("div",null,n.createElement("div",null,"Students:"),n.createElement("div",null,"Gathering Relics: ",a.jobAssignments.gatherRelics,n.createElement("span",null,n.createElement(T,{compact:!0,disabled:s<=0,onClick:function(){return e.assignGather()}},"+"),n.createElement(T,{compact:!0,disabled:a.jobAssignments.gatherRelics<=0,onClick:function(){return e.removeGather()}},"-")))),n.createElement("br",null),n.createElement("div",null,n.createElement("div",{className:"button-container"},n.createElement(T,{disabled:!this.studentTransaction.isValidPurchase(a,1),onClick:function(){return i(1,e.studentTransaction)},id:"hireStudent",tooltip:"Hire some students to dust off relics for you. They work for relics.\nRelics: "+this.studentTransaction.getCost(a,1)},"Hire a Student"))))}}]),a}(n.Component),R={light:{themeClass:"app app--light"},dark:{themeClass:"app app--dark"}},w=r.a.createContext({theme:R.dark,toggleTheme:function(){}}),A=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"onToggleTheme",value:function(e){var t=this.props.gameState;t.settings.darkMode=!t.settings.darkMode,e()}},{key:"render",value:function(){var e=this,t=this.props,a=t.onSave,n=t.onClearSave;return r.a.createElement("div",null,r.a.createElement("div",{className:"button-container"},r.a.createElement(T,{onClick:function(){return a()}},"Save"),r.a.createElement(T,{onClick:function(){return n()}},"Clear Save")),r.a.createElement("div",null,r.a.createElement(w.Consumer,null,(function(t){t.theme;var a=t.toggleTheme;return r.a.createElement("div",{className:"button-container"},r.a.createElement(T,{onClick:function(){return e.onToggleTheme(a)}},"Toggle Dark Mode"))}))),r.a.createElement("p",null,"Last Saved at $",this.props.gameState.saveTime?this.props.gameState.saveTime.toString():""))}}]),a}(r.a.Component);function I(e){var t=Math.floor(100*Math.random()+1);t>=95&&m(e,"The wind blows across the dusty plain"),10<=t&&t<=15&&(m(e,"A stranger shuffles up and hands something to you: +100 Relics!"),e.resourceState.relics+=100)}var P=function(){function e(t,a){Object(c.a)(this,e),this.saveClockId=void 0,this.resourceClockId=void 0,this.gameState=void 0,this.tickRatio=void 0,this.emitTick=void 0,this.maxTicks=void 0,this.tickNumber=0,this.saveClockId=setInterval((function(){return E(t)}),3e4),this.gameState=t,this.updateState(t),this.tickRatio=.05,this.maxTicks=100,this.emitTick=a}return Object(o.a)(e,[{key:"tick",value:function(){var e=Object(h.a)({},this.gameState);this.gameState.jobAssignments.gatherRelics&&(e.resourceState.relics+=this.gameState.jobAssignments.gatherRelics*this.tickRatio),this.tickNumber>=this.maxTicks&&(I(e),this.tickNumber=1),this.gameState=e,this.emitTick(e),this.tickNumber++}},{key:"updateState",value:function(e){var t=this;clearInterval(this.resourceClockId),this.resourceClockId=setInterval((function(){return t.tick()}),50)}},{key:"clearClock",value:function(){clearInterval(this.resourceClockId),clearInterval(this.saveClockId)}}]),e}(),M=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"getClassName",value:function(e){var t="padded-text journal__entry";switch(e.entryType){case"ACHIEVEMENT":t+=" journal__entry--achievement"}return t}},{key:"render",value:function(){var e=this,t=this.props,a=t.journalState,r=t.clearLog,i=a.entries.slice(0).reverse().map((function(t){return n.createElement("div",{className:e.getClassName(t)},t.entry)}));return n.createElement("div",{className:"panel--left-align journal-panel"},n.createElement(T,{onClick:function(){return r()}},"Clear Log"),n.createElement("div",{className:"journal"},i))}}]),a}(n.Component),G=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var e=this.props.gameState;return n.createElement("div",{className:"panel--right-align"},n.createElement("div",{className:"padded-text"},"Students: ",O(e),"/",e.resourceState.students),n.createElement("div",{className:"padded-text"},"Relics: ",e.resourceState.relics.toFixed()))}}]),a}(n.Component),L=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var e="nav-button";this.props.disabled&&(e+=" nav-button--disabled"),this.props.selected&&(e+=" nav-button--selected");var t=this.props.disabled?function(){}:this.props.onClick;return r.a.createElement("span",{className:e,onClick:t},this.props.children)}}]),a}(r.a.Component),_=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var e=this.props,t=e.onChangePanel,a=e.selected,n=e.gameState;return r.a.createElement("div",{className:"nav-panel"},r.a.createElement(L,{selected:"GENERATORS"===a,onClick:function(){return t("GENERATORS")}},"Dig Site 1"),n.resourceState.students>=10&&r.a.createElement(L,{selected:"LAB"===a,onClick:function(){return t("LAB")}},"Research Lab"),r.a.createElement(L,{selected:"SETTINGS"===a,onClick:function(){return t("SETTINGS")}},"Settings"))}}]),a}(r.a.Component);var x=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e;(e=this.props.gameState).achievements.labUnlocked||(e.achievements.labUnlocked=!0,function(e,t){e.journalState.entries.push(t),e.journalState.entries.length>=25&&e.journalState.entries.shift()}(e,{entry:"With your newfound stash of relics, you retreat to your personal labority!",entryType:"ACHIEVEMENT"}))}},{key:"render",value:function(){return r.a.createElement("div",null,"RESEARCH ONLY")}}]),a}(r.a.Component),D=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).clock=void 0,e.state={gameState:b()?k():j(),activePanel:"GENERATORS"},e}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.clock=new P(this.state.gameState,(function(t){return e.onTick(t)})),this.setState({activePanel:"GENERATORS"})}},{key:"onTick",value:function(e){this.setState({gameState:e})}},{key:"addCurrency",value:function(e,t){var a=Object(h.a)({},this.state.gameState);a.resourceState.relics+=t,m(a,"You dust off some potsherds."),this.setState({gameState:a})}},{key:"makePurchase",value:function(e,t){var a=Object(h.a)({},this.state.gameState);a=t.commitTransaction(a,e),this.setState({gameState:a}),t.updateClock&&this.clock.updateState(a)}},{key:"clearLog",value:function(){this.state.gameState.journalState.entries=[]}},{key:"changeActivePanel",value:function(e){this.setState({activePanel:e})}},{key:"save",value:function(){var e=Object(h.a)({},this.state.gameState);this.setState({gameState:e}),E(e)}},{key:"clearSave",value:function(){this.clock.clearClock();var e=j();e.saveTime=new Date,this.setState({gameState:e}),E(e),location.reload()}},{key:"render",value:function(){var e,t=this;switch(this.state.activePanel){case"SETTINGS":e=n.createElement(A,{gameState:this.state.gameState,onSave:function(){return t.save()},onClearSave:function(){return t.clearSave()}});break;case"LAB":e=n.createElement(x,{gameState:this.state.gameState});break;case"GENERATORS":default:e=n.createElement(N,{gameState:this.state.gameState,onAddCurrency:function(e,a){return t.addCurrency(e,a)},onPurchase:function(e,a){return t.makePurchase(e,a)}})}return n.createElement("div",{className:"core-panel"},n.createElement("div",{className:"core-panel__flex"},n.createElement("div",{className:"core-panel__left-column"},n.createElement(M,{clearLog:function(){return t.clearLog()},journalState:this.state.gameState.journalState})),n.createElement("div",{className:"core-panel__center-column"},n.createElement(_,{onChangePanel:function(e){return t.changeActivePanel(e)},selected:this.state.activePanel,gameState:this.state.gameState}),e),n.createElement("div",{className:"core-panel__right-column"},n.createElement(G,{gameState:this.state.gameState}))))}}]),a}(n.Component),B=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var n;Object(c.a)(this,a),(n=t.call(this,e)).state=void 0,n.toggleTheme=void 0;var r=b()&&k().settings.darkMode;return n.toggleTheme=function(){n.setState((function(e){return{theme:e.theme===R.dark?R.light:R.dark}}))},n.state={theme:r?R.dark:R.light,toggleTheme:n.toggleTheme},n}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement(w.Provider,{value:this.state},r.a.createElement("div",{className:this.state.theme.themeClass},r.a.createElement(D,null)))}}]),a}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(B,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[10,1,2]]]);
//# sourceMappingURL=main.5cb1b67b.chunk.js.map